{% extends "adminlte/base.html" %}
{% import "adminlte/layout.html" as layout with context %}
{% import "adminlte/widgets.html" as widgets with context %}

{% block navbar %}

{%- endblock navbar %}
{% block sidebar -%}
    <!-- sidebar: style can be found in sidebar.less -->
    <!-- sidebar menu: : style can be found in sidebar.less -->
    <div class="user-panel">

    </div>
    <ul class="sidebar-menu">
        <li class="header">OPTIONS</li>
        <li class="active">
            <a href="{{ url_for('index') }}">
                <i class="fa fa-dashboard"></i> <span>Dashboard</span>
            </a>
        </li>
    </ul>
    <!-- /.sidebar -->
{%- endblock sidebar %}
{% block content_header -%}
    <h1>
        Melbourne Pedestrian Statistics
        <small>Melbourne City Council Pedestrian Data Set</small>
    </h1>

{%- endblock content_header %}
{% block content -%}
    <!--
    <h4 class="page-header">
      Most Popular Spot Overall
      <small>2017 most popular </small>
    </h4>
    -->
    <!-- Small boxes (Stat box) -->
    <div class="row">

        {{ widgets.small_box(
                bgcolor="bg-aqua",
                header=most_pop_overall[0].count,
                body="Most Pedestrians for 2017: " + most_pop_overall[0].sensor_name,
                footerlink="#"
              ) }}

        {{ widgets.small_box(
                bgcolor="bg-green",
                header=most_pop_day[0].count,
                body="Most Popular Day: " + most_pop_day[0].day,
                footerlink="#"
              ) }}

        {{ widgets.small_box(
                bgcolor="bg-yellow",
                header=most_pop_time[0].count,
                body="Most Popular Time: " + most_pop_time[0].time,

                footerlink="#"
              ) }}

        {{ widgets.small_box(
                bgcolor="bg-red",
                header=most_pop_time[0].count,
                body="Most Popular Month: " + most_pop_month[0].month,

                footerlink="#"
              ) }}

    </div><!-- /.row -->



    <h1>Word Map</h1>
    <img src="../static/img/wordcloud.png">

    <h2>Google Map</h2>
    <div id="map" style="height:400px;"></div>

    <script>
        var map;

        function initMap() {
            console.log("hello");
            map = new google.maps.Map(document.getElementById('map'), {
                zoom: 2,
                center: {lat: -33.865427, lng: 151.196123},
                mapTypeId: 'terrain'
            });

            // Create a <script> tag and set the USGS URL as the source.
            var script = document.createElement('script');

            // This example uses a local copy of the GeoJSON stored at
            // http://earthquake.usgs.gov/earthquakes/feed/v1.0/summary/2.5_week.geojsonp
            script.src = 'https://developers.google.com/maps/documentation/javascript/examples/json/earthquake_GeoJSONP.js';
            document.getElementsByTagName('head')[0].appendChild(script);

            map.data.setStyle(function (feature) {
                var magnitude = feature.getProperty('mag');
                return {
                    icon: getCircle(magnitude)
                };
            });
        }

        function getCircle(magnitude) {
            console.log("YEp");
            return {
                path: google.maps.SymbolPath.CIRCLE,
                fillColor: 'red',
                fillOpacity: .2,
                scale: Math.pow(2, magnitude) / 2,
                strokeColor: 'white',
                strokeWeight: .5
            };
        }

        function eqfeed_callback(results) {
            map.data.addGeoJson(results);
        }
    </script>

    <script async defer
            src="https://maps.googleapis.com/maps/api/js?key=AIzaSyC91q4j-UaFY-TA0Y9gSe2EdLfUbOgUR9w&callback=initMap">
    </script>



{%- endblock content %}
